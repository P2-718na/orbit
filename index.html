<!DOCTYPE html>
<html lang="en-US" encoding="utf8">
<head>
  <title>Orbit</title>
  <style type="text/css">
    #canvass {
      width: 100%;
      height: 100%;
      z-index: -1;
      position: absolute;
      top: 0;
      left: 0;
    }
  </style>
</head>
<body>
  <div class="slidecontainer">
    <label for="dt">dt</label>
    <input type="range" min="1" max="50" value="1" class="slider" id="dt" onchange="reset()" name="dt"><br>
    <label for="w">w</label>
    <input type="int" min="0" max="100" value="100" class="slider" id="w" onchange="reset()" name="w">
    <label for="p">p</label>
    <input type="int" min="-300" max="300" value="10" cass="slider" id="p" onchange="reset()" name="p"><br>
    <label for="x">x</label>
    <input type="int" min="-300" max="300" value="200" class="slider" id="x" onchange="reset()" name="x">
  </div>
  <canvas class="dots" id="canvass">Your browser does not support canvas.</canvas>

 
</body>
<script type="text/javascript">
  time  = +new Date();
  let shitf = false;

    function drawLineWithArrows(ctx, x0,y0,x1,y1, strokeStyle = "#000000", lw = 1, aWidth = 5,aLength = 5, arrowStart = false ,arrowEnd = true){
    var dx=x1-x0;
    var dy=y1-y0;
    var angle=Math.atan2(dy,dx);
    var length=Math.sqrt(dx*dx+dy*dy);
    //
    let old = ctx.strokeStyle;
    let oldv = ctx.lineWidth;
    ctx.lineWidth = lw;

    ctx.strokeStyle = strokeStyle;
    ctx.translate(x0,y0);
    ctx.rotate(angle);
    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.lineTo(length,0);
    if(arrowStart){
        ctx.moveTo(aLength,-aWidth);
        ctx.lineTo(0,0);
        ctx.lineTo(aLength,aWidth);
    }
    if(arrowEnd){
        ctx.moveTo(length-aLength,-aWidth);
        ctx.lineTo(length,0);
        ctx.lineTo(length-aLength,aWidth);
    }
    //
    ctx.stroke();
    ctx.setTransform(1,0,0,1,0,0);
    ctx.strokeStyle = old;
    ctx.lineWidth = oldv;
}
 

const r = (x, y, x2, y2) => {
  return Math.sqrt(Math.pow((x - x2), 2) + Math.pow((y - y2), 2))
}

let dt = 0.0001;
const frame_dt = 0.001;

// Setup the canvas element.
var canvas = document.getElementById("canvass")
var context = canvas.getContext("2d")

// Get drawing context
var c3 = canvas.getContext( '2d' );

// Set Canvas dimensions
canvas.width   = window.innerWidth;
canvas.height  = window.innerHeight;

gamma = 1;

let pause = true;
let first = true;

let c = 100;
let vmax = c*0.90;
let v = 0;
let a = 500




L = 100;
const tx = 500;
S = {
  C: -1.5*L,
  dc:0,
  T: -L*0.5,
  dT: 0,
  E: 0,
  dE: 0,
  U: L,
  dU: 0
}

S1 = {
  C: -L,
  dc:0,
  T: 0,
  dT: 0,
  E: L*0.5,
  dE: 0,
  U: 1.5*L,
  dU: 0
}


// Animate the Circle
function step() {
  
}

// bad code



function animate3() {
    requestAnimationFrame( animate3 );


    if (pause && !first) {
      return
    }
    first = false,

    canvas.width = canvas.width


    //c3.clearRect( 0, 0 , canvas.width, canvas.height );

    
    //c3.beginPath();
//
    ////m
    //c3.arc( ax, ap,  1, 0, Math.PI * 2, false  );
    

    

    for (i = 0; i <= frame_dt; i+= dt) {
        Cold = S.T - L/gamma

        S.C += v*dt;
        S.T += v*dt;
        S1.E -= v*dt;
        S1.U -= v*dt;
        
        Cnew = S.T - L/gamma
        v += a/gamma/gamma/gamma*dt;
        //console.log(gamma, v)
        //console.log(Math.sqrt(1-v*v/c/c))
            console.log((Cold - Cnew)/dt)
        
    }


    c3.font = "20px Arial";
    c3.fillText("S", 200, 120);
    c3.fillText("S'", 200, 170);

    
    drawLineWithArrows(c3, tx, 200, tx, 50)
    // S
    c3.strokeStyle = "blue"
    l = S.T - S.C
    c3.strokeRect(S.T + tx, 102, -l/gamma,  16 );

    l = S.U - S.E
    c3.strokeStyle = "green"
    c3.strokeRect(S.E + tx, 100, l,  20 );

    // S'
    c3.strokeStyle = "blue"
    l = S1.T - S1.C
    c3.strokeRect(S1.T + tx, 152, -l,  16 );

    l = S1.U - S1.E
    c3.strokeStyle = "green"
    c3.strokeRect(S1.E + tx, 150, +l/gamma,  20 );

    gamma =1/Math.sqrt(1-v*v/c/c)

    //c3.lineTo(ax2, ap2)
    //c3.stroke();
}

const reset = () => {

  console.log("reset")
  canvas.width   = window.innerWidth;
  canvas.height  = window.innerHeight;


  c3.clearRect( 0, 0 , canvas.width, canvas.height );
  //dt = document.getElementById("dt").value / 1000;

    // Starting Position
    //x = 100;
    //p = .1;
//
    //w = +document.getElementById("w").value / 100;
    //mp = p = +document.getElementById("p").value / 100;
//
//
    //mx = x = +document.getElementById("x").value;

    //time = +new Date();


  }

  window.onresize = reset

  reset();
  animate3();

  function printMousePos(event) {
        pause = !pause;
    if (event.clientY < 200) return;


    x =  event.clientX - 500
    mx = x;
    
    p =  event.clientY  - 500;
    mp = p

    
}
document.addEventListener("click", printMousePos);
</script>

</html>